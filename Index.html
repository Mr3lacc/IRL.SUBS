<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>üé§ IRL.SUBS ‚Äî Live Voice-to-Text Ticker</title>
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: 'Arial', sans-serif;
           overflow: hidden;
           background: #000;
           color: #fff;
           height: 100vh;
           display: flex;
           flex-direction: column;
       }

       /* Theme Styles */
       .theme-basic {
           background: #000;
           color: #fff;
       }

       .theme-neon {
           background: #0a0a0f;
           color: #00ff41;
           text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41, 0 0 30px #00ff41;
       }

       .theme-blackwhite {
           background: #fff;
           color: #000;
       }

       .theme-comic {
           font-family: 'Comic Sans MS', cursive, sans-serif;
           background: #ffeb3b;
           color: #e91e63;
       }

       .theme-morse {
           font-family: 'Courier New', monospace;
           background: #1a1a1a;
           color: #00ff00;
           letter-spacing: 0.2em;
       }

       /* Settings Panel (Portrait) */
       .settings-panel {
           display: flex;
           flex-direction: column;
           padding: 20px;
           gap: 15px;
           background: rgba(0,0,0,0.9);
           color: #fff;
           max-width: 400px;
           margin: 0 auto;
           border-radius: 10px;
           margin-top: 20px;
       }

       .settings-panel h1 {
           text-align: center;
           font-size: 1.5em;
           margin-bottom: 10px;
       }

       .control-group {
           display: flex;
           flex-direction: column;
           gap: 8px;
       }

       .control-group label {
           font-weight: bold;
           font-size: 0.9em;
       }

       .control-group select,
       .control-group input {
           padding: 10px;
           border: none;
           border-radius: 5px;
           background: #333;
           color: #fff;
           font-size: 1em;
       }

       .button {
           padding: 15px;
           border: none;
           border-radius: 8px;
           font-size: 1.1em;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
       }

       .start-btn {
           background: #4CAF50;
           color: white;
       }

       .start-btn:hover {
           background: #45a049;
       }

       .stop-btn {
           background: #f44336;
           color: white;
       }

       .stop-btn:hover {
           background: #da190b;
       }

       .clear-btn {
           background: #ff9800;
           color: white;
       }

       .clear-btn:hover {
           background: #e68900;
       }

       /* Ticker Display (Landscape) */
       .ticker-container {
           display: none;
           height: 100vh;
           width: 100vw;
           position: relative;
           overflow: hidden;
           justify-content: center;
           align-items: center;
       }

       .ticker-text {
           white-space: nowrap;
           font-size: 4em;
           font-weight: bold;
           animation: scroll-left 20s linear infinite;
           position: absolute;
           width: max-content;
       }

       .ticker-text.outlined {
           text-shadow: 
               -2px -2px 0 #000,
               2px -2px 0 #000,
               -2px 2px 0 #000,
               2px 2px 0 #000;
       }

       @keyframes scroll-left {
           0% {
               transform: translateX(100vw);
           }
           100% {
               transform: translateX(-100%);
           }
       }

       /* Status indicators */
       .status {
           position: fixed;
           top: 20px;
           right: 20px;
           background: rgba(0,0,0,0.7);
           padding: 10px;
           border-radius: 5px;
           font-size: 0.9em;
       }

       .listening {
           color: #4CAF50;
       }

       .stopped {
           color: #f44336;
       }

       /* Instructions */
       .instructions {
           margin-top: 20px;
           padding: 15px;
           background: rgba(255,255,255,0.1);
           border-radius: 8px;
           font-size: 0.9em;
           line-height: 1.4;
       }

       /* Responsive adjustments */
       @media (orientation: landscape) {
           .settings-panel {
               display: none;
           }
           
           .ticker-container {
               display: flex;
           }

           .ticker-text {
               font-size: 6vmin;
           }
       }

       @media (orientation: portrait) {
           .settings-panel {
               display: flex;
           }
           
           .ticker-container {
               display: none;
           }
       }
   </style>
</head>
<body class="theme-basic">

   <!-- Settings Panel (Portrait Mode) -->
   <div class="settings-panel">
       <h1>üé§ IRL.SUBS</h1>
       <p style="text-align: center; opacity: 0.8;">Live Voice-to-Text Ticker</p>

       <div class="control-group">
           <label for="theme-select">üé® Visual Theme</label>
           <select id="theme-select">
               <option value="basic">Basic (Black & White)</option>
               <option value="neon">Neon Green</option>
               <option value="blackwhite">High Contrast B&W</option>
               <option value="comic">Comic Sans Fun</option>
               <option value="morse">Morse Code Style</option>
           </select>
       </div>

       <div class="control-group">
           <label for="scroll-speed">‚ö° Scroll Speed</label>
           <input type="range" id="scroll-speed" min="5" max="30" value="20" step="1">
           <span id="speed-value">20s per cycle</span>
       </div>

       <div class="control-group">
           <label for="language-select">üåç Language</label>
           <select id="language-select">
               <option value="en-US">English (US)</option>
               <option value="en-GB">English (UK)</option>
               <option value="es-ES">Spanish</option>
               <option value="fr-FR">French</option>
               <option value="de-DE">German</option>
               <option value="it-IT">Italian</option>
               <option value="pt-BR">Portuguese</option>
               <option value="ja-JP">Japanese</option>
               <option value="ko-KR">Korean</option>
               <option value="zh-CN">Chinese</option>
           </select>
       </div>

       <div class="control-group">
           <label>‚ôø Accessibility</label>
           <div style="display: flex; gap: 10px;">
               <input type="checkbox" id="text-outline"> 
               <label for="text-outline" style="font-weight: normal;">Text Outline</label>
           </div>
       </div>

       <button class="button start-btn" id="start-btn">üéôÔ∏è Start Listening</button>
       <button class="button stop-btn" id="stop-btn" style="display: none;">‚èπÔ∏è Stop</button>
       <button class="button clear-btn" id="clear-btn">üóëÔ∏è Clear Text</button>

       <div class="instructions">
           <strong>üìã Instructions:</strong><br>
           ‚Ä¢ Rotate to landscape for fullscreen ticker<br>
           ‚Ä¢ Volume ‚¨áÔ∏è = Repeat last phrase<br>
           ‚Ä¢ Volume ‚¨ÜÔ∏è = Skip/Clear wrong words<br>
           ‚Ä¢ Works best in quiet environments
       </div>
   </div>

   <!-- Ticker Display (Landscape Mode) -->
   <div class="ticker-container">
       <div class="ticker-text" id="ticker-text">üé§ IRL.SUBS Ready - Start speaking...</div>
   </div>

   <!-- Status Indicator -->
   <div class="status" id="status">
       <span class="stopped">‚óè Stopped</span>
   </div>

   <script>
       let recognition;
       let isListening = false;
       let currentText = '';
       let lastPhrase = '';
       let scrollSpeed = 20;
       let currentLanguage = 'en-US';

       // DOM Elements
       const startBtn = document.getElementById('start-btn');
       const stopBtn = document.getElementById('stop-btn');
       const clearBtn = document.getElementById('clear-btn');
       const themeSelect = document.getElementById('theme-select');
       const speedSlider = document.getElementById('scroll-speed');
       const speedValue = document.getElementById('speed-value');
       const languageSelect = document.getElementById('language-select');
       const textOutline = document.getElementById('text-outline');
       const tickerText = document.getElementById('ticker-text');
       const status = document.getElementById('status');

       // Initialize Speech Recognition
       function initSpeechRecognition() {
           if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
               alert('Speech recognition not supported in this browser. Please use Chrome or Edge.');
               return false;
           }

           const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
           recognition = new SpeechRecognition();
           
           recognition.continuous = true;
           recognition.interimResults = true;
           recognition.lang = currentLanguage;
           
           recognition.onstart = () => {
               console.log('Speech recognition started');
               isListening = true;
               updateStatus(true);
           };

           recognition.onresult = (event) => {
               let interimTranscript = '';
               let finalTranscript = '';

               for (let i = event.resultIndex; i < event.results.length; i++) {
                   const transcript = event.results[i][0].transcript;
                   if (event.results[i].isFinal) {
                       finalTranscript += transcript + ' ';
                   } else {
                       interimTranscript += transcript;
                   }
               }

               if (finalTranscript) {
                   currentText += finalTranscript;
                   lastPhrase = finalTranscript.trim();
                   updateTicker();
               }
           };

           recognition.onerror = (event) => {
               console.error('Speech recognition error:', event.error);
               if (event.error === 'not-allowed') {
                   alert('Microphone access denied. Please allow microphone access and refresh the page.');
               }
           };

           recognition.onend = () => {
               console.log('Speech recognition ended');
               if (isListening) {
                   // Restart if we're still supposed to be listening
                   setTimeout(() => recognition.start(), 100);
               }
           };

           return true;
       }

       // Update ticker text
       function updateTicker() {
           tickerText.textContent = currentText || 'üé§ IRL.SUBS Ready - Start speaking...';
           updateScrollAnimation();
       }

       // Update scroll animation speed
       function updateScrollAnimation() {
           tickerText.style.animationDuration = scrollSpeed + 's';
       }

       // Update status indicator
       function updateStatus(listening) {
           if (listening) {
               status.innerHTML = '<span class="listening">‚óè Listening</span>';
           } else {
               status.innerHTML = '<span class="stopped">‚óè Stopped</span>';
           }
       }

       // Theme switching
       function changeTheme(theme) {
           document.body.className = `theme-${theme}`;
       }

       // Start listening
       function startListening() {
           if (!recognition && !initSpeechRecognition()) {
               return;
           }

           recognition.lang = currentLanguage;
           recognition.start();
           startBtn.style.display = 'none';
           stopBtn.style.display = 'block';
       }

       // Stop listening
       function stopListening() {
           if (recognition) {
               isListening = false;
               recognition.stop();
           }
           updateStatus(false);
           startBtn.style.display = 'block';
           stopBtn.style.display = 'none';
       }

       // Clear text
       function clearText() {
           currentText = '';
           updateTicker();
       }

       // Repeat last phrase
       function repeatLastPhrase() {
           if (lastPhrase) {
               currentText += ' [REPEAT: ' + lastPhrase + '] ';
               updateTicker();
           }
       }

       // Skip/clear wrong words
       function skipWords() {
           // Remove last 10 characters or last word
           const words = currentText.trim().split(' ');
           if (words.length > 1) {
               words.pop();
               currentText = words.join(' ') + ' ';
               updateTicker();
           }
       }

       // Event Listeners
       startBtn.addEventListener('click', startListening);
       stopBtn.addEventListener('click', stopListening);
       clearBtn.addEventListener('click', clearText);

       themeSelect.addEventListener('change', (e) => {
           changeTheme(e.target.value);
       });

       speedSlider.addEventListener('input', (e) => {
           scrollSpeed = e.target.value;
           speedValue.textContent = scrollSpeed + 's per cycle';
           updateScrollAnimation();
       });

       languageSelect.addEventListener('change', (e) => {
           currentLanguage = e.target.value;
           if (recognition) {
               recognition.lang = currentLanguage;
           }
       });

       textOutline.addEventListener('change', (e) => {
           if (e.target.checked) {
               tickerText.classList.add('outlined');
           } else {
               tickerText.classList.remove('outlined');
           }
       });

       // Hardware button support (Volume buttons)
       document.addEventListener('keydown', (e) => {
           // Volume Down (or Down Arrow) - Repeat last phrase
           if (e.key === 'ArrowDown' || e.key === 'VolumeDown') {
               e.preventDefault();
               repeatLastPhrase();
           }
           
           // Volume Up (or Up Arrow) - Skip/clear wrong words
           if (e.key === 'ArrowUp' || e.key === 'VolumeUp') {
               e.preventDefault();
               skipWords();
           }

           // Space bar - Toggle listening
           if (e.key === ' ') {
               e.preventDefault();
               if (isListening) {
                   stopListening();
               } else {
                   startListening();
               }
           }

           // Escape - Clear text
           if (e.key === 'Escape') {
               e.preventDefault();
               clearText();
           }
       });

       // Initialize
       updateTicker();
       updateScrollAnimation();

       // Handle orientation changes
       window.addEventListener('orientationchange', () => {
           setTimeout(() => {
               updateScrollAnimation();
           }, 500);
       });

       // Request microphone permissions on load
       if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
           navigator.mediaDevices.getUserMedia({ audio: true })
               .then(() => console.log('Microphone access granted'))
               .catch(() => console.log('Microphone access denied'));
       }
   </script>

</body>
</html>
